<?xml version="1.0"?>
<PropertyList>

  <path>GROZA.ac</path>

  <effect>
    <inherits-from>Effects/Tu154b-GrozaGlass</inherits-from>
    <object-name>Glass</object-name>
  </effect>
  <effect>
    <inherits-from>Effects/Tu154b_Groza</inherits-from>
    <object-name>Groza_Panel</object-name>
    <object-name>b_off</object-name>
    <object-name>b_on</object-name>
    <object-name>Handle</object-name>
    <object-name>kn_angle</object-name>
    <object-name>kn_arcs</object-name>
    <object-name>kn_brt</object-name>
    <object-name>kn_contrast</object-name>
    <object-name>kn_freq</object-name>
    <object-name>kn_mode</object-name>
    <object-name>kn_range</object-name>
    <object-name>lamp_cover</object-name>
    <object-name>Mounting</object-name>
  </effect>

  <animation>
    <type>noshadow</type>
    <object-name>l2.1_Sector</object-name>
    <object-name>l2.2_Sector</object-name>
    <object-name>l2.3_Curtain</object-name>
  </animation>

 <effect>
  <object-name>l5_Net</object-name>
  <inherits-from>Effects/azimuth</inherits-from>
  <parameters>
   <lightmap-factor type="float" n="0">
    <use>instrumentation/GROZA/screen/arcs_brt</use>
   </lightmap-factor>
  </parameters>
 </effect>

  <animation>
    <type>material</type>
    <object-name>l4_Glass</object-name>
    <object-name>l5_Net</object-name>
    <emission>
      <red-prop>instrumentation/jsbsim/systems/lighting/lightsrc/cockpit-panels_r</red-prop>
      <green-prop>instrumentation/jsbsim/systems/lighting/lightsrc/cockpit-panels_g</green-prop>
      <blue-prop>instrumentation/jsbsim/systems/lighting/lightsrc/cockpit-panels_b</blue-prop>
    </emission>
  </animation>

  <animation>
    <type>texrotate</type>
    <object-name>l2.1_Sector</object-name>
    <property>instrumentation/GROZA/screen/sec_dir</property>
    <offset-deg>-3</offset-deg>
    <center>
      <x>0.25</x>
      <y>0.25</y>
    </center>
    <axis>
      <x>0</x>
      <y>0</y>
      <z>1</z>
    </axis>
  </animation>
  <animation>
    <type>texrotate</type>
    <object-name>l2.2_Sector</object-name>
    <property>instrumentation/GROZA/screen/sec_dir</property>
    <offset-deg>3</offset-deg>
    <center>
      <x>0.25</x>
      <y>0.25</y>
    </center>
    <axis>
      <x>0</x>
      <y>0</y>
      <z>-1</z>
    </axis>
  </animation>
  <animation>
    <type>texrotate</type>
    <object-name>l2.3_Curtain</object-name>
    <property>instrumentation/GROZA/screen/sec_dir</property>
    <factor>-0.25</factor>
    <center>
      <x>0.75</x>
      <y>0.25</y>
    </center>
    <axis>
      <x>0</x>
      <y>0</y>
      <z>1</z>
    </axis>
  </animation>
  <animation>
    <type>select</type>
    <object-name>l2.1_Sector</object-name>    
    <condition>
     <and>
       <equals>
         <property>instrumentation/GROZA/screen/fetch_dir</property>
         <value>1</value>
       </equals>
       <equals>
         <property>instrumentation/GROZA/screen/show_fade</property>
         <value>1</value>
       </equals>
     </and>
    </condition>
  </animation>
  <animation>
    <type>select</type>
    <object-name>l2.2_Sector</object-name>
    <condition>
     <and>
       <equals>
         <property>instrumentation/GROZA/screen/fetch_dir</property>
         <value>0</value>
       </equals>
       <equals>
         <property>instrumentation/GROZA/screen/show_fade</property>
         <value>1</value>
       </equals>
     </and>
    </condition>
  </animation>
  <animation>
    <type>select</type>
    <object-name>l2.3_Curtain</object-name>
    <condition>
     <equals>
       <property>instrumentation/GROZA/screen/show_fade</property>
       <value>1</value>
     </equals>
    </condition>
  </animation>

  <animation>
    <type>material</type>
    <object-name>Groza_Panel</object-name>
    <emission>
      <red-prop>instrumentation/jsbsim/systems/lighting/lightsrc/cockpit-panels_r</red-prop>
      <green-prop>instrumentation/jsbsim/systems/lighting/lightsrc/cockpit-panels_g</green-prop>
      <blue-prop>instrumentation/jsbsim/systems/lighting/lightsrc/cockpit-panels_b</blue-prop>
    </emission>
  </animation>

  <!-- Hide canvas (saves FPS) -->
  <animation>
    <type>select</type>
    <object-name>l1_Groza</object-name>
    <condition>
     <not>
       <or>
         <equals>
           <property>instrumentation/GROZA/status/stop_seq</property>
           <value>3</value>
         </equals>
         <equals>
           <property>instrumentation/GROZA/status/pause_seq</property>
           <value>2</value>
         </equals>
       </or>
     </not>
    </condition>
  </animation>
  <animation>
    <type>select</type>
    <object-name>l3_Screen</object-name>
    <condition>
     <or>
       <equals>
         <property>instrumentation/GROZA/status/stop_seq</property>
         <value>3</value>
       </equals>
       <equals>
         <property>instrumentation/GROZA/status/pause_seq</property>
         <value>2</value>
       </equals>
     </or>
    </condition>
  </animation>

  <!-- Knobs and buttons -->
  <animation>
    <type>translate</type>
    <object-name>b_on</object-name>
    <property>instrumentation/GROZA/buttons/b_on</property>
    <factor>0.00375</factor>
    <axis>
      <x>-1.0</x>
      <y>0.0</y>
      <z>0.0</z>
    </axis>
  </animation>
  <animation>
    <type>pick</type>
    <object-name>b_on</object-name>
    <action>
      <button>0</button>
      <repeatable>false</repeatable>
      <binding>
        <command>property-assign</command>
        <property>instrumentation/GROZA/buttons/b_on</property>
        <value>1</value>
      </binding>
      <binding>
        <command>property-toggle</command>
        <property>tu154/sound/events/button</property>
      </binding>
      <mod-up>
        <binding>
          <command>property-assign</command>
          <property>instrumentation/GROZA/buttons/b_on</property>
          <value>0</value>
        </binding>
        <binding>
          <command>property-toggle</command>
          <property>tu154/sound/events/button</property>
        </binding>
      </mod-up>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Radar: enable (%s)</label>
        <tooltip-id>Groza_on</tooltip-id>
        <mapping>on-off</mapping>
        <property>instrumentation/GROZA/status/power</property>
      </binding>
    </hovered>
  </animation>

  <animation>
    <type>translate</type>
    <object-name>b_off</object-name>
    <property>instrumentation/GROZA/buttons/b_off</property>
    <factor>0.00375</factor>
    <axis>
      <x>-1.0</x>
      <y>0.0</y>
      <z>0.0</z>
    </axis>
  </animation>
  <animation>
    <type>pick</type>
    <object-name>b_off</object-name>
    <action>
      <button>0</button>
      <repeatable>false</repeatable>
      <binding>
        <command>property-assign</command>
        <property>instrumentation/GROZA/buttons/b_off</property>
        <value>1</value>
      </binding>
      <binding>
        <command>property-toggle</command>
        <property>tu154/sound/events/button</property>
      </binding>
      <mod-up>
        <binding>
          <command>property-assign</command>
          <property>instrumentation/GROZA/buttons/b_off</property>
          <value>0</value>
        </binding>
        <binding>
          <command>property-toggle</command>
          <property>tu154/sound/events/button</property>
        </binding>
      </mod-up>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Radar: disable (%s)</label>
        <tooltip-id>Groza_off</tooltip-id>
        <mapping>on-off</mapping>
        <property>instrumentation/GROZA/status/power</property>
      </binding>
    </hovered>
  </animation>

  <animation>
    <type>pick</type>
    <object-name>kn_freq</object-name>
    <action>
      <button>0</button>
      <repeatable>false</repeatable>
      <binding>
        <command>property-cycle</command>
        <property>instrumentation/GROZA/screen/show_fade</property>
        <value type="bool">1</value>
        <value type="bool">0</value>
      </binding>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>%s</label>
        <tooltip-id>Groza_fade</tooltip-id>
        <mapping>nasal</mapping>
        <property>instrumentation/GROZA/screen/show_fade</property>
        <script>return sprintf("Frequency\n(not implemented,\n\"Storage tube\" mode: %s)", ["ON", "OFF"][arg[0]])</script>
      </binding>
    </hovered>
  </animation>

  <animation>
    <type>knob</type>
    <object-name>kn_angle</object-name>
    <property>instrumentation/GROZA/info/pitch_add</property>
    <factor>-9</factor>
    <offset-deg>0</offset-deg>
    <center>
      <x-m>0</x-m>
      <y-m>-0.051</y-m>
      <z-m>0.76</z-m>
    </center>
    <axis>
      <x>1</x>
      <y>0</y>
      <z>0</z>
    </axis>
    <action>
      <binding>
        <command>property-adjust</command>
        <property>instrumentation/GROZA/info/pitch_add</property>
        <factor>1</factor>
        <min>-15</min>
        <max>11</max><!--<max>10</max>--><!--one extra step in needed due to wrapping-->
        <wrap>true</wrap>
      </binding>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Weather / Turb. slope: %3i deg.</label>
        <tooltip-id>Groza_angle</tooltip-id>
        <mapping>nasal</mapping>
        <property>instrumentation/GROZA/info/pitch_add</property>
        <script>return arg[0]</script>
      </binding>
    </hovered>
  </animation>

  <animation>
    <type>knob</type>
    <object-name>kn_arcs</object-name>
    <property>instrumentation/GROZA/screen/arcs_bright</property>
    <factor>-255</factor>
    <offset-deg>127.5</offset-deg>
    <center>
      <x-m>0</x-m>
      <y-m>0.024</y-m>
      <z-m>0.7805</z-m>
    </center>
    <axis>
      <x>1</x>
      <y>0</y>
      <z>0</z>
    </axis>
    <action>
      <binding>
        <command>property-adjust</command>
        <property>instrumentation/GROZA/screen/arcs_bright</property>
        <factor>0.01</factor>
        <min>0</min>
        <max>1.01</max><!--<max>1</max>--><!--one extra step in needed due to wrapping-->
        <wrap>true</wrap>
      </binding>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Grid: %3d%%</label>
        <tooltip-id>Groza_arcs</tooltip-id>
        <mapping>percent</mapping>
        <property>instrumentation/GROZA/screen/arcs_bright</property>
      </binding>
    </hovered>
  </animation>
  
  <animation>
    <type>knob</type>
    <object-name>kn_mode</object-name>
    <property>instrumentation/GROZA/global_mode</property>
    <factor>-30</factor>
    <offset-deg>90</offset-deg>
    <center>
      <x-m>0</x-m>
      <y-m>-0.117</y-m>
      <z-m>0.735</z-m>
    </center>
    <axis>
      <x>1</x>
      <y>0</y>
      <z>0</z>
    </axis>
    <action>
      <binding>
        <command>property-adjust</command>
        <property>instrumentation/GROZA/global_mode</property>
        <factor>1</factor>
        <min>1</min>
        <max>5</max><!--<max>4</max>--><!--one extra step in needed due to wrapping-->
        <wrap>true</wrap>
      </binding>
      <binding>
        <command>property-toggle</command>
        <property>tu154/sound/events/knob</property>
      </binding>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Radar mode: %s</label>
        <tooltip-id>Groza_mode</tooltip-id>
        <mapping>nasal</mapping>
        <property>instrumentation/GROZA/global_mode</property>
        <script>
          var result =  ["Standby", "Terrain", "Weather", "Turbulence"][arg[0] - 1];
          if ((arg[0] - 1 == 1) and getprop("instrumentation/GROZA/settings/tcas-blip-radius") and getprop("instrumentation/tcas/serviceable")) {
            return result ~ " + TCAS"
          }
          return result
        </script>
      </binding>
    </hovered>
  </animation>

  <animation>
    <type>knob</type>
    <object-name>kn_brt</object-name>
    <property>instrumentation/GROZA/screen/brightness</property>
    <factor>-255</factor>
    <offset-deg>127.5</offset-deg>
    <center>
      <x-m>0</x-m>
      <y-m>-0.0735</y-m>
      <z-m>0.7215</z-m>
    </center>
    <axis>
      <x>1</x>
      <y>0</y>
      <z>0</z>
    </axis>
    <action>
      <binding>
        <command>property-adjust</command>
        <property>instrumentation/GROZA/screen/brightness</property>
        <factor>0.01</factor>
        <min>0</min>
        <max>1.01</max><!--<max>1</max>--><!--one extra step in needed due to wrapping-->
        <wrap>true</wrap>
      </binding>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Brightness: %4d%%</label>
        <tooltip-id>Groza_brt</tooltip-id>
        <mapping>nasal</mapping>
        <property>instrumentation/GROZA/screen/brightness</property>
        <script>return 200*(arg[0]-0.5)</script>
      </binding>
    </hovered>
  </animation>

  <animation>
    <type>knob</type>
    <object-name>kn_contrast</object-name>
    <property>instrumentation/GROZA/info/contrast</property>
    <factor>-127.5</factor>
    <offset-deg>127.5</offset-deg>
    <center>
      <x-m>0</x-m>
      <y-m>-0.0285</y-m>
      <z-m>0.7215</z-m>
    </center>
    <axis>
      <x>1</x>
      <y>0</y>
      <z>0</z>
    </axis>
    <action>
      <binding>
        <command>property-adjust</command>
        <property>instrumentation/GROZA/info/contrast</property>
        <factor>0.1</factor>
        <min>0</min>
        <max>2.1</max><!--<max>2</max>--><!--one extra step in needed due to wrapping-->
        <wrap>true</wrap>
      </binding>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Contrast: %2.1fx</label>
        <tooltip-id>Groza_contrast</tooltip-id>
        <property>instrumentation/GROZA/info/contrast</property>
      </binding>
    </hovered>
  </animation>

  <animation>
    <type>knob</type>
    <object-name>kn_range</object-name>
    <property>instrumentation/GROZA/range/range_pos</property>
    <factor>-30</factor>
    <offset-deg>60</offset-deg>
    <center>
      <x-m>0</x-m>
      <y-m>0.015</y-m>
      <z-m>0.735</z-m>
    </center>
    <axis>
      <x>1</x>
      <y>0</y>
      <z>0</z>
    </axis>
    <action>
      <binding>
        <command>property-adjust</command>
        <property>instrumentation/GROZA/range/range_pos</property>
        <factor>1</factor>
        <min>0</min>
        <max>5</max><!--<max>4</max>--><!--one extra step in needed due to wrapping-->
        <wrap>true</wrap>
      </binding>
      <binding>
        <command>property-toggle</command>
        <property>tu154/sound/events/knob</property>
      </binding>
    </action>
    <hovered>
      <binding>
        <command>set-tooltip</command>
        <label>Range: %3u km</label>
        <tooltip-id>Groza_range</tooltip-id>
        <mapping>nasal</mapping>
        <property>instrumentation/GROZA/range/range</property>
        <script>return arg[0]</script>
      </binding>
    </hovered>
  </animation>

</PropertyList>

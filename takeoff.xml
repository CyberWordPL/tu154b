<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="http://jsbsim.sourceforge.net/JSBSimScript.xsl"?>
<runscript xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://jsbsim.sourceforge.net/JSBSimScript.xsd"
    name="Tu-154">
  <description>Takeoff Tu-154b</description>
  <use aircraft="tu154b" initialize="reset00"/>
  <run start="0.0" end="200" dt="0.0083333">

    <event name="On-ground trim">
      <description>The aircraft is trimmed on-ground.</description>
      <condition>sim-time-sec ge 0.25</condition>
      <set name="metrics/stabilizer-factor" value="-0.48"/>      
      <set name="simulation/do_trim" value="2"/>
      <set name="ap/roll-hold" value="1"/>
      <set name="ap/pitch-selector" value="0"/>
      <notify/>
    </event>


    <event name="Both brakes applied">
      <description>Brake testing</description>
      <condition>sim-time-sec ge 1</condition>
      <set name="fcs/right-brake-cmd-norm" value="1"/>
      <set name="fcs/left-brake-cmd-norm" value="1"/>
      <notify/>
    </event>

    <event name="Flaps extend">
      <description>Flaps extend</description>
      <condition>sim-time-sec ge 2</condition>
      <set name="fcs/flap-cmd-norm" value="0.6"/>
      <notify/>
    </event>


    <event name="Start engine: Starter">
      <description>The starter for both engines is turned on.</description>
      <condition>sim-time-sec ge 3</condition>
      <set name="propulsion/starter_cmd" value="1"/>
      <notify/>
    </event>

    <event name="Start engine: Cutoff">
      <description>Cutoff is turned off, allowing fuel to flow.</description>
      <condition>propulsion/engine[0]/n2 ge 4.0</condition>
      <set name="propulsion/cutoff_cmd" value="0"/>
      <set name="fcs/throttle-cmd-norm[0]" value="0.4"/>
      <set name="fcs/throttle-cmd-norm[1]" value="0.4"/>
      <set name="fcs/throttle-cmd-norm[2]" value="0.4"/>
      
      <notify>
        <property>propulsion/engine[0]/n2</property>
        <property>propulsion/engine[1]/n2</property>
        <property>propulsion/starter_cmd</property>
        <property>propulsion/engine[0]/thrust</property>
        <property>propulsion/engine[1]/thrust</property>
      </notify>
    </event>

    <event name="Throttle-up">
      <description>Move throttle to full for take-off.</description>
      <condition>propulsion/engine[0]/n2 ge 5.0</condition>
      <delay>5.0</delay>
      <set name="fcs/throttle-cmd-norm[0]" value="1.0"/>
      <set name="fcs/throttle-cmd-norm[1]" value="1.0"/>
      <set name="fcs/throttle-cmd-norm[2]" value="1.0"/>
      
      <notify>
        <property>propulsion/engine[0]/n2</property>
        <property>propulsion/engine[1]/n2</property>
        <property>propulsion/engine[0]/thrust</property>
        <property>propulsion/engine[1]/thrust</property>
        <property>velocities/vc-kts</property>
      </notify>
    </event>


    <event name="Brakes released">
      <description>Go</description>
      <condition>propulsion/engine[0]/n2 ge 90.0</condition>
      <set name="fcs/right-brake-cmd-norm" value="0"/>
      <set name="fcs/left-brake-cmd-norm" value="0"/>
      <notify/>
    </event>


    <event name="Rotation">
      <description>Rotation</description>
      <notify>
        <property>velocities/vc-kts</property>
</notify>
      <condition>
        velocities/vc-kts >= 131.8
      </condition>

      <set name="fcs/elevator-cmd-norm" value="-0.8"/>

    </event>



    <event name="retract gear">
      <description>retract gear</description>
      <notify>
        <property>velocities/vc-kts</property>
      </notify>
      <condition>
        position/h-agl-ft >= 100
      </condition>
      <set name="gear/gear-cmd-norm" value="0"/>
    </event>



    <event name="stop rotation">
      <description>stop rotation </description>
      <notify/>
      <condition>
                aero/alpha-deg >= 13
      </condition>      

   <set name="fcs/elevator-cmd-norm" value="-0.19"/>

    </event>



    <event name="retract flaps">
      <description>retract flaps</description>
      <notify>
        <property>velocities/vc-kts</property>
      </notify>
      <condition>
        position/h-agl-ft >= 1500
      </condition>
      
  
  <set name="fcs/flap-cmd-norm" value="0"/>
        
    </event>


    <event name="AP hold alt">
      <description>hold pitch on</description>
      <notify>
        <property>velocities/vt-fps</property>
      </notify>
      <condition>sim-time-sec ge 107  </condition>

  <set name="ap/input-altitude" value="3300"/>
  <set name="ap/input-speed" value="400"/>

  <set name="ap/pitch-selector" value="2"/>

<!--  <set name="ap/stab-input-pitch-rad" value="0.3"/>-->
    <set name="ap/pitch-hold" value="1"/>
    
    </event>



    <event name="down engine">
      <description>down engines</description>
      <notify>
        <property>velocities/vc-kts</property>
</notify>

      <condition>
      
        velocities/vc-kts >= 220
      </condition>
      <set name="fcs/throttle-cmd-norm[0]" value="0.7"/>
      <set name="fcs/throttle-cmd-norm[1]" value="0.7"/>
      <set name="fcs/throttle-cmd-norm[2]" value="0.7"/>
<!--
  <set name="ap/input-pitch-rad" value="0.1"/>
  
   <set name="fcs/elevator-cmd-norm" value="-0.4"/>
    -->        
    </event>

<!--
    <event name="Alt fix">
      <condition>sim-time-sec ge 120  </condition>
      <notify> 
      <property>velocities/vt-fps</property> 
      </notify>

  <set name="ap/input-altitude" value="1500"/>
  <set name="ap/pitch-selector" value="1"/>

    </event>



    <event name="Speed fix">
      <condition>sim-time-sec ge 180  </condition>
      <notify> 
      <property>velocities/vt-fps</property> 
      </notify>


  <set name="ap/input-speed" value="400"/>
  <set name="ap/pitch-selector" value="2"/>

    </event>

-->


  </run>

</runscript>
